# API ë¬¸ì„œ v1.1.0 ğŸ“¡
**Girls Band Tabi - RESTful API ê°€ì´ë“œ**

**ìµœì‹  ì—…ë°ì´íŠ¸**: 2025ë…„ 11ì›” 17ì¼  
**ë²„ì „**: v1.1.0  
**ìƒíƒœ**: âœ… ìµœì‹   
**Base URL**: `http://localhost:8080`  
**OpenAPI ìŠ¤í™**: `/api-docs`  
**Swagger UI**: `/swagger-ui.html`  

## ëª©ì°¨

1. [API ê°œìš” ë° ì„¤ê³„ ì›ì¹™](#api-ê°œìš”-ë°-ì„¤ê³„-ì›ì¹™)
2. [ì¸ì¦ ë° ì¸ê°€](#ì¸ì¦-ë°-ì¸ê°€)
3. [ì™„ì „í•œ ì—”ë“œí¬ì¸íŠ¸ ì°¸ì¡°](#ì™„ì „í•œ-ì—”ë“œí¬ì¸íŠ¸-ì°¸ì¡°)
4. [ìš”ì²­/ì‘ë‹µ í˜•ì‹](#ìš”ì²­ì‘ë‹µ-í˜•ì‹)
5. [ì˜¤ë¥˜ ì²˜ë¦¬ ë° RFC 7807](#ì˜¤ë¥˜-ì²˜ë¦¬-ë°-rfc-7807)
6. [ì†ë„ ì œí•œ ë° í˜ì´ì§€ë„¤ì´ì…˜](#ì†ë„-ì œí•œ-ë°-í˜ì´ì§€ë„¤ì´ì…˜)
7. [í•„í„°ë§ ë° ê²€ìƒ‰ ê¸°ëŠ¥](#í•„í„°ë§-ë°-ê²€ìƒ‰-ê¸°ëŠ¥)
8. [íŒŒì¼ ì—…ë¡œë“œ ë° ë¯¸ë””ì–´ ì²˜ë¦¬](#íŒŒì¼-ì—…ë¡œë“œ-ë°-ë¯¸ë””ì–´-ì²˜ë¦¬)
9. [OpenAPI/Swagger í†µí•©](#openapiswagger-í†µí•©)
10. [í…ŒìŠ¤íŠ¸ ì „ëµ ë° ë„êµ¬](#í…ŒìŠ¤íŠ¸-ì „ëµ-ë°-ë„êµ¬)

---

## API ê°œìš” ë° ì„¤ê³„ ì›ì¹™

### ì•„í‚¤í…ì²˜
Girls Band Tabi APIëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì•„í‚¤í…ì²˜ ì›ì¹™ì„ ë°”íƒ•ìœ¼ë¡œ **Spring Boot 3.x**ë¡œ êµ¬ì¶•ë˜ì—ˆìŠµë‹ˆë‹¤:

- **ê³„ì•½ ìš°ì„  ì„¤ê³„(Contract-First Design)**: OpenAPI 3.1 ì‚¬ì–‘ì´ API ê³„ì•½ì„ ì •ì˜
- **RESTful ì•„í‚¤í…ì²˜**: ëª…í™•í•œ ë¦¬ì†ŒìŠ¤ ì§€í–¥ URLì„ ê°€ì§„ REST ì›ì¹™ ì¤€ìˆ˜
- **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì¤€ë¹„**: ëª…í™•í•œ ëª¨ë“ˆ ê²½ê³„ë¥¼ ê°€ì§„ Spring Modulith
- **ë¦¬ì•¡í‹°ë¸Œ ì§€ì›**: í•„ìš”í•œ ê²½ìš° ë…¼ë¸”ë¡œí‚¹ ì‘ì—…ì„ ìœ„í•œ WebFlux
- **ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„**: ëª…í™•í•œ ë„ë©”ì¸ ê²½ê³„ë¥¼ ê°€ì§„ ê¸°ëŠ¥ ìš°ì„  ì¡°ì§

### í•µì‹¬ ì„¤ê³„ ì›ì¹™

#### 1. ì¼ê´€ì„± ìš°ì„ 
- ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìœ„í•œ í‘œì¤€í™”ëœ `ApiResponse<T>` ë˜í¼
- RFC 7807 Problem Detailsë¥¼ ë”°ë¥´ëŠ” ì¼ê´€ëœ ì˜¤ë¥˜ í˜•ì‹
- í†µì¼ëœ ëª…ëª… ê·œì¹™ ë° URL íŒ¨í„´
- ì˜ˆì¸¡ ê°€ëŠ¥í•œ HTTP ìƒíƒœ ì½”ë“œ ì‚¬ìš©

#### 2. ê°œë°œì ê²½í—˜
- ì˜ˆì œê°€ í¬í•¨ëœ í¬ê´„ì ì¸ OpenAPI ë¬¸ì„œ
- í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì¸í„°ë™í‹°ë¸Œ Swagger UI
- ë³µêµ¬ ì§€ì¹¨ì´ ìˆëŠ” ëª…í™•í•œ ì˜¤ë¥˜ ë©”ì‹œì§€
- ì¼ê´€ëœ í•„ë“œ ëª…ëª… ë° ë°ì´í„° íƒ€ì…

#### 3. ì„¤ê³„ë¶€í„° ë³´ì•ˆ
- ë¦¬í”„ë ˆì‹œ í† í° ë¡œí…Œì´ì…˜ì´ ìˆëŠ” JWT ê¸°ë°˜ ì¸ì¦
- ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´(RBAC)
- Redisë¥¼ í†µí•œ ì†ë„ ì œí•œ
- ì…ë ¥ ê²€ì¦ ë° ë¬´ê²°ì„± ê²€ì‚¬
- ë¯¼ê°í•œ ì‘ì—…ì— ëŒ€í•œ ê°ì‚¬ ë¡œê¹…

#### 4. ì„±ëŠ¥ ë° í™•ì¥ì„±
- ëŒ€ìš©ëŸ‰ ë°ì´í„°ì…‹ì„ ìœ„í•œ í˜ì´ì§€ë„¤ì´ì…˜
- êµ¬ì„± ê°€ëŠ¥í•œ TTLì„ ê°€ì§„ ìºì‹±
- ìœ ìµí•œ ê²½ìš° ë…¼ë¸”ë¡œí‚¹ I/O
- íš¨ìœ¨ì ì¸ ì¿¼ë¦¬ ìµœì í™”
- ì—°ê²° í’€ë§ ë° ë¦¬ì†ŒìŠ¤ ê´€ë¦¬

#### 5. ê´€ì°°ê°€ëŠ¥ì„±
- ìƒê´€ê´€ê³„ IDë¥¼ ê°€ì§„ í¬ê´„ì ì¸ ë¡œê¹…
- Micrometerë¥¼ í†µí•œ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- ìš”ì²­ ì¶”ì  ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
- í—¬ìŠ¤ ì²´í¬ ë° ìƒíƒœ ì—”ë“œí¬ì¸íŠ¸

### API ë²„ì „ ê´€ë¦¬ ì „ëµ
- **URI ë²„ì „ë‹**: ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ì— `/api/v1/` ì ‘ë‘ì‚¬ ì‚¬ìš©
- **í›„ë°© í˜¸í™˜ì„±**: ë²„ì „ ë¹„í˜¸í™œ ì•Œë¦¼ì„ í¬í•¨í•œ ì‹œë§¨í‹± ë²„ì „ë‹
- **ë§ˆì´ê·¸ë ˆì´ì…˜ ì§€ì›**: ë²„ì „ë³„ ë¬¸ì„œ ë° ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### ê¸°ìˆ  ìŠ¤íƒ
- **í”„ë ˆì„ì›Œí¬**: Spring Boot 3.x, Spring Security, Spring Data JPA
- **ë°ì´í„°ë² ì´ìŠ¤**: Flyway ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ê°€ì§„ PostgreSQL
- **ìºì‹±**: Lettuce ì»¤ë„¥í„°ë¥¼ ê°€ì§„ Redis
- **ì €ì¥ì†Œ**: ë¯¸ë””ì–´ íŒŒì¼ì„ ìœ„í•œ Cloudflare R2
- **ê´€ì°°ê°€ëŠ¥ì„±**: Micrometer, Prometheus, Actuator
- **ë¬¸ì„œ**: SpringDoc OpenAPI 3

---

## ì¸ì¦ ë° ì¸ê°€

### ê°œìš”
APIëŠ” ë‹¤ìŒ ê¸°ëŠ¥ì„ ê°€ì§„ **JWT (JSON Web Token)** ê¸°ë°˜ ì¸ì¦ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:
- ë‹¨ê¸° ì§€ì† ì•¡ì„¸ìŠ¤ í† í°(15ë¶„)
- ë¡œí…Œì´ì…˜ì„ ê°€ì§„ ì¥ê¸° ì§€ì† ë¦¬í”„ë ˆì‹œ í† í°(7ì¼)
- ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´(RBAC)
- Redisë¥¼ í†µí•œ ì„¸ì…˜ ê´€ë¦¬
- ì„ íƒì  OAuth2 í†µí•©

### í† í° êµ¬ì¡°

#### ì•¡ì„¸ìŠ¤ í† í°
```json
{
  "sub": "550e8400-e29b-41d4-a716-446655440000",
  "iat": 1668240000,
  "exp": 1668241200,
  "iss": "girlsbandtabi",
  "aud": "girlsbandtabi-api",
  "type": "access",
  "roles": ["USER"]
}
```

#### ë¦¬í”„ë ˆì‹œ í† í°
```json
{
  "sub": "550e8400-e29b-41d4-a716-446655440000",
  "jti": "abc123-def456-ghi789",
  "iat": 1668240000,
  "exp": 1668844800,
  "iss": "girlsbandtabi",
  "type": "refresh"
}
```

### ì¸ì¦ í”Œë¡œìš°

#### 1. ì‚¬ìš©ì ë“±ë¡
```http
POST /api/v1/auth/register
Content-Type: application/json

{
  "username": "user@example.com",
  "nickname": "TravelUser",
  "password": "SecurePassword123!"
}
```

**Response:**
```json
{
  "success": true,
  "statusCode": 201,
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiJ9..."
  },
  "metadata": {
    "requestId": "req_1699804800_1234",
    "timestamp": "2024-11-12T10:00:00Z",
    "version": "v1"
  }
}
```

#### 2. ì‚¬ìš©ì ë¡œê·¸ì¸
```http
POST /api/v1/auth/login
Content-Type: application/json

{
  "username": "user@example.com",
  "password": "SecurePassword123!"
}
```

#### 3. í† í° ìƒˆë¡œê³ ì¹¨
```http
POST /api/v1/auth/refresh
Content-Type: application/json

{
  "refreshToken": "eyJhbGciOiJIUzI1NiJ9..."
}
```

**Response:** New token pair with rotated refresh token.

#### 4. ë¡œê·¸ì•„ì›ƒ
```http
POST /api/v1/auth/logout
Content-Type: application/json

{
  "refreshToken": "eyJhbGciOiJIUzI1NiJ9..."
}
```

### ì¸ê°€ í—¤ë”

#### Bearer í† í° ì¸ì¦
```http
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...
```

#### ì„ íƒì‚¬í•­: ì¿ í‚¤ ê¸°ë°˜ ì¸ì¦
```http
Cookie: ACCESS_TOKEN=eyJhbGciOiJIUzI1NiJ9...
```

### ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´

#### ì‚¬ìš©ì ì—­í• 
- **USER**: ê¸°ë³¸ ê¶Œí•œì„ ê°€ì§„ ì¼ë°˜ ì‚¬ìš©ì
- **ADMIN**: ì „ì²´ ì‹œìŠ¤í…œ ì ‘ê·¼ ê¶Œí•œì„ ê°€ì§„ ê´€ë¦¬ì
- **PROJECT_ADMIN**: í”„ë¡œì íŠ¸ë³„ ê´€ë¦¬ì ê¶Œí•œ

#### ê¶Œí•œ ì˜ˆì œ
```kotlin
@PreAuthorize("isAuthenticated()")                              // Any authenticated user
@PreAuthorize("hasRole('ADMIN')")                              // Global admin only
@PreAuthorize("hasRole('ADMIN') or @projectAuth.isProjectAdminById(#projectId)") // Admin or project admin
```

### ë³´ì•ˆ í—¤ë”
```http
X-Request-ID: req_1699804800_1234
X-Correlation-ID: trace_abc123
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1699804860
```

---

## ì™„ì „í•œ ì—”ë“œí¬ì¸íŠ¸ ì°¸ì¡°

### ì¸ì¦ ì—”ë“œí¬ì¸íŠ¸

#### POST /api/v1/auth/register
ìƒˆë¡œìš´ ì‚¬ìš©ì ê³„ì •ì„ ë“±ë¡í•©ë‹ˆë‹¤.

**ìš”ì²­ ëª¨ë“œ:**
```json
{
  "username": "user@example.com",
  "nickname": "TravelUser",
  "password": "SecurePassword123!"
}
```

**ê²€ì¦:**
- `username`: ìœ íš¨í•œ ì´ë©”ì¼ ì£¼ì†Œ (í•„ìˆ˜)
- `nickname`: ë¹„ì–´ìˆì§€ ì•Šì€ ë¬¸ìì—´ (í•„ìˆ˜)
- `password`: ë³µì¡ì„± ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ëŠ” ë¹„ì–´ìˆì§€ ì•Šì€ ë¬¸ìì—´ (í•„ìˆ˜)

**ì‘ë‹µ:** 201 Created with í† í° ìŒ

**ì˜¤ë¥˜ ì‚¬ë¡€:**
- 400: ê²€ì¦ ì‹¤íŒ¨
- 409: ì´ë©”ì¼ì´ ì´ë¯¸ ì¡´ì¬

#### POST /api/v1/auth/login
ì‚¬ìš©ì ìê²© ì¦ëª…ì„ ì¸ì¦í•©ë‹ˆë‹¤.

**ìš”ì²­ ëª¨ë“œ:**
```json
{
  "username": "user@example.com",
  "password": "SecurePassword123!"
}
```

**ì‘ë‹µ:** 200 OK with í† í° ìŒ

**ì˜¤ë¥˜ ì‚¬ë¡€:**
- 400: ì˜ëª»ëœ ìš”ì²­ í˜•ì‹
- 401: ì˜ëª»ëœ ìê²© ì¦ëª…

#### POST /api/v1/auth/refresh
ë§Œë£Œëœ ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.

**ìš”ì²­ ëª¨ë“œ:**
```json
{
  "refreshToken": "eyJhbGciOiJIUzI1NiJ9..."
}
```

**ì‘ë‹µ:** 200 OK with ìƒˆë¡œìš´ í† í° ìŒ

**ì˜¤ë¥˜ ì‚¬ë¡€:**
- 401: ì˜ëª»ë˜ê±°ë‚˜ ë§Œë£Œëœ ë¦¬í”„ë ˆì‹œ í† í°

#### POST /api/v1/auth/logout
ë¦¬í”„ë ˆì‹œ í† í°ì„ ì·¨ì†Œí•©ë‹ˆë‹¤.

**ìš”ì²­ ëª¨ë“œ:**
```json
{
  "refreshToken": "eyJhbGciOiJIUzI1NiJ9..."
}
```

**ì‘ë‹µ:** 200 OK (ë¹ˆ ì‘ë‹µ)

### ì¥ì†Œ ê´€ë¦¬ ì—”ë“œí¬ì¸íŠ¸

#### GET /api/v1/projects/{projectId}/places
ì„ íƒì  í•„í„°ë§ì„ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ì˜ ì¥ì†Œ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

**ê²½ë¡œ ë§¤ê°œë³€ìˆ˜:**
- `projectId`: í”„ë¡œì íŠ¸ ì‹ë³„ì

**ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜:**
- `unitIds`: ë‹¨ì²´ IDë¡œ í•„í„°ë§ (ì„ íƒì‚¬í•­)
- `includeShared`: ê³µìœ  ì¥ì†Œ í¬í•¨ (default: false)
- `page`: í˜ì´ì§€ ë²ˆí˜¸ (0 ê¸°ë°˜, default: 0)
- `size`: í˜ì´ì§€ í¬ê¸° (default: 20)
- `sort`: ì •ë ¬ ê¸°ì¤€ (e.g., "name,asc")

**ì‘ë‹µ:** 200 OK with í˜ì´ì§€ë„¤ì´ì…˜ëœ ì¥ì†Œ ëª©ë¡

**ì˜ˆì œ ìš”ì²­:**
```http
GET /api/v1/projects/girls-band-cry/places?page=0&size=10&sort=name,asc
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...
```

**ì˜ˆì œ ì‘ë‹µ (2025-11-17 ì—…ë°ì´íŠ¸):**
```json
{
  "success": true,
  "statusCode": 200,
  "data": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440205",
      "name": "ì¹´ì™€ì‚¬í‚¤ ì—­ ë™ìª½ì¶œêµ¬ ì• ê´‘ì¥",
      "types": ["filming_location", "tour_spot"],
      "introText": "ê±¸ì¦ˆë°´ë“œ í¬ë¼ì´ 1í™” ì˜¤í”„ë‹ ì´¬ì˜ì§€ë¡œ íŒ¬ë“¤ì´ ì„±ì§€ìˆœë¡€í•˜ëŠ” ëŒ€í‘œ ìŠ¤í¿ì…ë‹ˆë‹¤.",
      "latitude": 35.5308,
      "longitude": 139.6981,
      "thumbnailUrl": "https://cdn.girlsbandtabi.dev/places/205/cover.jpg",
      "tags": ["station", "opening"],
      "regionSummary": {
        "code": "JPN-14-201-301",
        "primaryName": "ê°€ë‚˜ê°€ì™€í˜„ ì¹´ì™€ì‚¬í‚¤ì‹œ ì¹´ì™€ì‚¬í‚¤êµ¬",
        "path": "ì¼ë³¸ > ê°€ë‚˜ê°€ì™€í˜„ > ì¹´ì™€ì‚¬í‚¤ì‹œ > ì¹´ì™€ì‚¬í‚¤êµ¬",
        "level": 3
      }
    }
  ],
  "pagination": {
    "currentPage": 0,
    "pageSize": 10,
    "totalPages": 3,
    "totalItems": 25,
    "isFirst": true,
    "isLast": false,
    "hasNext": true,
    "hasPrevious": false,
    "numberOfItems": 10
  },
  "metadata": {
    "requestId": "req_1699804800_1234",
    "timestamp": "2025-11-17T10:00:00Z",
    "version": "v1",
    "processingTimeMs": 108
  }
}
```

#### GET /api/v1/projects/{projectId}/places/{placeId}
ìƒì„¸í•œ ì¥ì†Œ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

**ê²½ë¡œ ë§¤ê°œë³€ìˆ˜:**
- `projectId`: í”„ë¡œì íŠ¸ ì‹ë³„ì
- `placeId`: ì¥ì†Œ ì‹ë³„ì

**ì‘ë‹µ:** 200 OK with ì¥ì†Œ ì„¸ë¶€ ì •ë³´

**ì˜ˆì œ ì‘ë‹µ (ìš”ì•½/ì§€ì—­ ë©”íƒ€ ì—…ë°ì´íŠ¸ í¬í•¨):**
```json
{
  "success": true,
  "statusCode": 200,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440205",
    "name": "ì¹´ì™€ì‚¬í‚¤ ì—­ ë™ìª½ì¶œêµ¬ ì• ê´‘ì¥",
    "types": ["filming_location", "tour_spot"],
    "introText": "ê±¸ì¦ˆë°´ë“œ í¬ë¼ì´ 1í™” ì˜¤í”„ë‹ ì´¬ì˜ì§€ë¡œ íŒ¬ë“¤ì´ ì„±ì§€ìˆœë¡€í•˜ëŠ” ëŒ€í‘œ ìŠ¤í¿ì…ë‹ˆë‹¤.",
    "description": "ì¹´ì™€ì‚¬í‚¤ì—­ ë™ìª½ ê´‘ì¥ì—ì„œ ì´¬ì˜ëœ ëŒ€í‘œ ì¥ë©´ì…ë‹ˆë‹¤.",
    "latitude": 35.5308,
    "longitude": 139.6981,
    "address": "ì¼ë³¸ ê°€ë‚˜ê°€ì™€í˜„ ì¹´ì™€ì‚¬í‚¤ì‹œ ì¹´ì™€ì‚¬í‚¤êµ¬",
    "tags": ["station", "opening"],
    "primaryImage": {
      "imageId": "img-001",
      "url": "https://cdn.girlsbandtabi.dev/places/205/cover.jpg",
      "filename": "kawasaki-square.jpg",
      "contentType": "image/jpeg",
      "fileSize": 983221,
      "uploadedAt": "2025-11-10T09:12:00Z",
      "isPrimary": true
    },
    "images": [
      {
        "imageId": "img-001",
        "url": "https://cdn.girlsbandtabi.dev/places/205/cover.jpg",
        "filename": "kawasaki-square.jpg",
        "contentType": "image/jpeg",
        "fileSize": 983221,
        "uploadedAt": "2025-11-10T09:12:00Z",
        "isPrimary": true
      }
    ],
    "regionSummary": {
      "code": "JPN-14-201-301",
      "primaryName": "ê°€ë‚˜ê°€ì™€í˜„ ì¹´ì™€ì‚¬í‚¤ì‹œ ì¹´ì™€ì‚¬í‚¤êµ¬",
      "path": "ì¼ë³¸ > ê°€ë‚˜ê°€ì™€í˜„ > ì¹´ì™€ì‚¬í‚¤ì‹œ > ì¹´ì™€ì‚¬í‚¤êµ¬",
      "level": 3
    },
    "createdAt": "2025-11-09T12:00:00Z",
    "updatedAt": "2025-11-15T08:30:00Z"
  },
  "metadata": {
    "requestId": "req_1699804800_5678",
    "timestamp": "2025-11-17T10:05:00Z",
    "version": "v1",
    "processingTimeMs": 94
  }
}
```

#### GET /api/v1/projects/{projectId}/places/within-bounds
ì§€ë¦¬ì  ê²½ê³„ ë‚´ì˜ ì¥ì†Œë“¤ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

**ê²½ë¡œ ë§¤ê°œë³€ìˆ˜:**
- `projectId`: í”„ë¡œì íŠ¸ ì‹ë³„ì

**ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜:**
- `north`: ë¶ìª½ ìœ„ë„ ê²½ê³„ (í•„ìˆ˜)
- `south`: ë‚¨ìª½ ìœ„ë„ ê²½ê³„ (í•„ìˆ˜)
- `east`: ë™ìª½ ê²½ë„ ê²½ê³„ (í•„ìˆ˜)
- `west`: ì„œìª½ ê²½ë„ ê²½ê³„ (í•„ìˆ˜)

**ì‘ë‹µ:** 200 OK with ì¥ì†Œ ëª©ë¡

#### GET /api/v1/projects/{projectId}/places/nearby
íŠ¹ì • ìœ„ì¹˜ ê·¼ì²˜ì˜ ì¥ì†Œë“¤ì„ ì°¾ìŠµë‹ˆë‹¤.

**ê²½ë¡œ ë§¤ê°œë³€ìˆ˜:**
- `projectId`: í”„ë¡œì íŠ¸ ì‹ë³„ì

**ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜:**
- `lat`: ìœ„ë„ (í•„ìˆ˜)
- `lon`: ê²½ë„ (í•„ìˆ˜)
- `radius`: ë¯¸í„° ë‹¨ìœ„ì˜ ê²€ìƒ‰ ë°˜ê²½ (í•„ìˆ˜)

**ì‘ë‹µ:** 200 OK with ê·¼ì²˜ ì¥ì†Œë“¤

#### POST /api/v1/projects/{projectId}/places
ìƒˆë¡œìš´ ì¥ì†Œë¥¼ ìƒì„±í•©ë‹ˆë‹¤ (ê´€ë¦¬ì ì „ìš©).

**ì¸ê°€:** `ADMIN` ë˜ëŠ” `PROJECT_ADMIN`

**ìš”ì²­ ëª¨ë“œ:**
```json
{
  "name": "ì¹´ì™€ì‚¬í‚¤ ê´‘ì¥",
  "types": ["filming_location", "tour_spot"],
  "introText": "íŒ¬ë“¤ì´ ì¸ì¦ìƒ·ì„ ë‚¨ê¸°ëŠ” ëŒ€í‘œ ì´¬ì˜ì§€.",
  "description": "ê±¸ì¦ˆë°´ë“œ í¬ë¼ì´ 1í™” ì˜¤í”„ë‹ ì´¬ì˜ì§€",
  "latitude": 35.5308,
  "longitude": 139.6981,
  "address": "ì¼ë³¸ ê°€ë‚˜ê°€ì™€í˜„ ì¹´ì™€ì‚¬í‚¤ì‹œ",
  "unitIds": ["550e8400-e29b-41d4-a716-446655440111"]
}
```

> â“˜ `type` ë‹¨ì¼ ë¬¸ìì—´ í•„ë“œëŠ” 2025-11-17 ë°°í¬ì—ì„œ ì œê±°ë˜ì—ˆìœ¼ë©°, ë‹¤ì¤‘ ë¶„ë¥˜ëŠ” ë°˜ë“œì‹œ `types` ë°°ì—´ë¡œ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.

**ì‘ë‹µ:** 201 Created with ì¥ì†Œ ì„¸ë¶€ ì •ë³´

#### PUT /api/v1/projects/{projectId}/places/{placeId}
ê¸°ì¡´ ì¥ì†Œë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤ (ê´€ë¦¬ì ì „ìš©).

**ì¸ê°€:** `ADMIN` ë˜ëŠ” `PROJECT_ADMIN`

**ì‘ë‹µ:** 200 OK with ì—…ë°ì´íŠ¸ëœ ì¥ì†Œ ì„¸ë¶€ ì •ë³´

#### DELETE /api/v1/projects/{projectId}/places/{placeId}
ì¥ì†Œë¥¼ ì‚­ì œí•©ë‹ˆë‹¤ (ê´€ë¦¬ì ì „ìš©).

**ì¸ê°€:** `ADMIN` ë˜ëŠ” `PROJECT_ADMIN`

**ì‘ë‹µ:** 204 No Content

### íŒŒì¼ ì—…ë¡œë“œ ì—”ë“œí¬ì¸íŠ¸

#### POST /api/v1/uploads/presigned-url
íŒŒì¼ ì—…ë¡œë“œë¥¼ ìœ„í•œ ì‚¬ì „ ì„œëª…ëœ URLì„ ì–»ìŠµë‹ˆë‹¤.

**ì¸ê°€:** í•„ìˆ˜

**ìš”ì²­ ëª¨ë“œ:**
```json
{
  "fileName": "venue-photo.jpg",
  "fileSize": 2048576,
  "contentType": "image/jpeg",
  "purpose": "place_photo",
  "metadata": {
    "placeId": "place-001",
    "description": "Venue interior"
  }
}
```

**ì‘ë‹µ:** 200 OK with ì‚¬ì „ ì„œëª…ëœ URL

**ì˜ˆì œ ì‘ë‹µ:**
```json
{
  "success": true,
  "statusCode": 200,
  "data": {
    "uploadId": "upload_abc123def456",
    "presignedUrl": "https://girlsbandtabi.r2.example.com/uploads/abc123...?signature=xyz",
    "expiresAt": "2024-11-12T10:15:00Z",
    "maxFileSize": 10485760,
    "allowedContentTypes": ["image/jpeg", "image/png", "image/webp"]
  },
  "metadata": {
    "requestId": "req_1699804800_9999",
    "timestamp": "2024-11-12T10:00:00Z",
    "version": "v1"
  }
}
```

#### POST /api/v1/uploads/{uploadId}/confirm
Confirm successful file upload.

**Authorization:** Required

**Path Parameters:**
- `uploadId`: Upload identifier from presigned URL request

**Response:** 200 OK with upload confirmation

#### GET /api/v1/uploads/my
List user's uploaded files.

**Authorization:** Required

**Query Parameters:**
- `page`: Page number (0-based, default: 0)
- `size`: Page size (default: 20)

**Response:** 200 OK with paginated uploads list

#### DELETE /api/v1/uploads/{uploadId}
Delete an uploaded file.

**Authorization:** Required (own uploads only)

**Response:** 204 No Content

### Search Endpoints

#### GET /api/v1/search/places
Global place search across all projects.

**Query Parameters:**
- `q`: Search query (required)
- `project`: Filter by project code (optional)
- `page`: Page number (default: 0)
- `size`: Page size (default: 20)

**Response:** 200 OK with search results

#### GET /api/v1/search/units
Search for units/bands.

**Query Parameters:**
- `q`: Search query (required)
- `page`: Page number (default: 0)
- `size`: Page size (default: 20)

**Response:** 200 OK with unit search results

### Health and Monitoring Endpoints

#### GET /actuator/health
System health check.

**Response:** 200 OK with health status

```json
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP",
      "details": {
        "database": "PostgreSQL",
        "validationQuery": "isValid()"
      }
    },
    "redis": {
      "status": "UP",
      "details": {
        "version": "7.0.0"
      }
    },
    "r2": {
      "status": "UP",
      "details": {
        "bucket": "girlsbandtabi"
      }
    }
  }
}
```

#### GET /actuator/metrics
Prometheus metrics endpoint.

**Response:** Metrics in Prometheus format

---

## ìš”ì²­/ì‘ë‹µ í˜•ì‹

### í‘œì¤€í™”ëœ ApiResponse ë˜í¼
ëª¨ë“  API ì‘ë‹µì€ ì˜¤ë¥˜ ì‚¬ë¡€ì— ëŒ€í•œ RFC 7807 Problem Detailsë¥¼ êµ¬í˜„í•˜ëŠ” ì¼ê´€ëœ `ApiResponse<T>` ë˜í¼ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

#### ì„±ê³µ ì‘ë‹µ êµ¬ì¡°
```json
{
  "success": true,
  "statusCode": 200,
  "data": "<response_data>",
  "metadata": {
    "requestId": "req_1699804800_1234",
    "timestamp": "2024-11-12T10:00:00Z",
    "version": "v1",
    "processingTimeMs": 125,
    "correlationId": "trace_abc123",
    "serverId": "instance-001"
  },
  "pagination": {
    "currentPage": 0,
    "pageSize": 20,
    "totalPages": 5,
    "totalItems": 100,
    "isFirst": true,
    "isLast": false,
    "hasNext": true,
    "hasPrevious": false,
    "numberOfItems": 20
  }
}
```

#### ì˜¤ë¥˜ ì‘ë‹µ êµ¬ì¡°
```json
{
  "success": false,
  "statusCode": 400,
  "data": null,
  "error": {
    "code": "VALIDATION_FAILED",
    "message": "Request validation failed",
    "details": {
      "violatedConstraints": ["email format", "password strength"]
    },
    "fieldErrors": [
      {
        "field": "email",
        "message": "must be a valid email address",
        "rejectedValue": "invalid-email",
        "code": "EMAIL_INVALID"
      }
    ],
    "type": "https://docs.api.example.com/errors#validation-failed",
    "instance": "/api/v1/auth/register",
    "recoveryActions": [
      "Check the email format",
      "Ensure password meets complexity requirements"
    ],
    "retryInfo": {
      "recommended": false,
      "retryAfterMs": null,
      "maxRetries": null,
      "strategy": null
    }
  },
  "metadata": {
    "requestId": "req_1699804800_1234",
    "timestamp": "2024-11-12T10:00:00Z",
    "version": "v1"
  }
}
```

### ì½˜í…ì¸  íƒ€ì…
- **ìš”ì²­ Content-Type**: `application/json`
- **ì‘ë‹µ Content-Type**: `application/json; charset=utf-8`
- **íŒŒì¼ ì—…ë¡œë“œ**: ì§ì ‘ ì—…ë¡œë“œì—ëŠ” `multipart/form-data`, ì‚¬ì „ ì„œëª…ëœ URLì—ëŠ” `application/json`

### ë‚ ì§œ ë° ì‹œê°„ í˜•ì‹
- **í˜•ì‹**: UTC íƒ€ì„ì¡´ì„ ê°€ì§„ ISO 8601 (`YYYY-MM-DDTHH:mm:ssZ`)
- **ì˜ˆì œ**: `2024-11-12T10:00:00Z`
- **íƒ€ì„ì¡´**: ëª¨ë“  íƒ€ì„ìŠ¤íƒ¬í”„ëŠ” UTCë¡œ í‘œì‹œ

### í˜ì´ì§€ë„¤ì´ì…˜ í˜•ì‹
```json
{
  "pagination": {
    "currentPage": 0,
    "pageSize": 20,
    "totalPages": 5,
    "totalItems": 100,
    "isFirst": true,
    "isLast": false,
    "hasNext": true,
    "hasPrevious": false,
    "numberOfItems": 20
  }
}
```

### í•„ë“œ ëª…ëª… ê·œì¹™
- **camelCase** JSON í•„ë“œìš©
- **snake_case** ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ìš© (ë ˆê±°ì‹œ ì§€ì›ì´ í•„ìš”í•œ ê²½ìš°)
- **kebab-case** URL ê²½ë¡œìš©
- **UPPER_CASE** ìƒìˆ˜ ë° ì˜¤ë¥˜ ì½”ë“œìš©

---

## ì˜¤ë¥˜ ì²˜ë¦¬ ë° RFC 7807

### ì˜¤ë¥˜ ì‘ë‹µ ì² í•™
APIëŠ” ê°œë°œìì™€ ìë™í™”ëœ ì‹œìŠ¤í…œ ëª¨ë‘ê°€ ì˜¤ë¥˜ë¥¼ ì´í•´í•˜ê³  ë³µêµ¬í•  ìˆ˜ ìˆë„ë¡ ì¼ê´€ë˜ê³  ê¸°ê³„ íŒë… ê°€ëŠ¥í•œ ì˜¤ë¥˜ ì‘ë‹µì„ ì œê³µí•˜ê¸° ìœ„í•´ **RFC 7807 Problem Details for HTTP APIs**ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

### ì˜¤ë¥˜ ë²”ì£¼

#### 1. í´ë¼ì´ì–¸íŠ¸ ì˜¤ë¥˜ (4xx)

**400 Bad Request - ê²€ì¦ ì˜¤ë¥˜**
```json
{
  "success": false,
  "statusCode": 400,
  "error": {
    "code": "VALIDATION_FAILED",
    "message": "Request validation failed",
    "fieldErrors": [
      {
        "field": "email",
        "message": "must be a valid email address",
        "rejectedValue": "not-an-email",
        "code": "EMAIL_INVALID"
      },
      {
        "field": "password",
        "message": "must be at least 8 characters",
        "rejectedValue": null,
        "code": "PASSWORD_TOO_SHORT"
      }
    ],
    "type": "https://docs.api.example.com/errors#validation-failed",
    "instance": "/api/v1/auth/register"
  }
}
```

**401 Unauthorized - ì¸ì¦ í•„ìš”**
```json
{
  "success": false,
  "statusCode": 401,
  "error": {
    "code": "AUTHENTICATION_REQUIRED",
    "message": "Authentication is required to access this resource",
    "type": "https://docs.api.example.com/errors#authentication-required",
    "instance": "/api/v1/places",
    "recoveryActions": [
      "Please provide valid authentication credentials"
    ]
  }
}
```

**403 Forbidden - ë¶ˆì¶©ë¶„í•œ ê¶Œí•œ**
```json
{
  "success": false,
  "statusCode": 403,
  "error": {
    "code": "ACCESS_DENIED",
    "message": "You do not have permission to access this resource",
    "type": "https://docs.api.example.com/errors#access-denied",
    "instance": "/api/v1/admin/users",
    "recoveryActions": [
      "Contact your administrator to request access",
      "Ensure you are using an account with appropriate permissions"
    ]
  }
}
```

**404 Not Found - ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ**
```json
{
  "success": false,
  "statusCode": 404,
  "error": {
    "code": "RESOURCE_NOT_FOUND",
    "message": "The requested resource was not found",
    "type": "https://docs.api.example.com/errors#resource-not-found",
    "instance": "/api/v1/places/non-existent-id"
  }
}
```

**409 Conflict - ë¦¬ì†ŒìŠ¤ ì¶©ëŒ**
```json
{
  "success": false,
  "statusCode": 409,
  "error": {
    "code": "CONFLICT",
    "message": "The resource was updated by another request. Refresh and try again.",
    "type": "https://docs.api.example.com/errors#conflict",
    "instance": "/api/v1/places/place-001",
    "recoveryActions": [
      "Refresh the resource and retry your operation",
      "Check for concurrent modifications"
    ],
    "retryInfo": {
      "recommended": true,
      "retryAfterMs": 1000,
      "maxRetries": 3,
      "strategy": "IMMEDIATE_RETRY"
    }
  }
}
```

**429 Too Many Requests - Rate Limit Exceeded**
```json
{
  "success": false,
  "statusCode": 429,
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "Too many requests. Please try again later.",
    "type": "https://docs.api.example.com/errors#rate-limit-exceeded",
    "instance": "/api/v1/auth/login",
    "retryInfo": {
      "recommended": true,
      "retryAfterMs": 60000,
      "maxRetries": 3,
      "strategy": "EXPONENTIAL_BACKOFF"
    }
  }
}
```

#### 2. Server Errors (5xx)

**500 Internal Server Error**
```json
{
  "success": false,
  "statusCode": 500,
  "error": {
    "code": "INTERNAL_SERVER_ERROR",
    "message": "An unexpected error occurred. Please try again later.",
    "type": "https://docs.api.example.com/errors#internal-server-error",
    "instance": "/api/v1/places",
    "recoveryActions": [
      "Please try again in a few moments",
      "Contact support if the problem persists"
    ],
    "retryInfo": {
      "recommended": true,
      "retryAfterMs": 30000,
      "maxRetries": 2,
      "strategy": "EXPONENTIAL_BACKOFF"
    }
  }
}
```

**503 Service Unavailable - Circuit Breaker Open**
```json
{
  "success": false,
  "statusCode": 503,
  "error": {
    "code": "CIRCUIT_BREAKER_OPEN",
    "message": "Service temporarily unavailable. Please try again later.",
    "type": "https://docs.api.example.com/errors#circuit-breaker-open",
    "instance": "/api/v1/places/search",
    "details": {
      "serviceName": "search-service"
    },
    "retryInfo": {
      "recommended": true,
      "retryAfterMs": 30000,
      "maxRetries": 3,
      "strategy": "EXPONENTIAL_BACKOFF"
    }
  }
}
```

### Transaction-Specific Errors

**Optimistic Locking Failure**
```json
{
  "success": false,
  "statusCode": 409,
  "error": {
    "code": "OPTIMISTIC_LOCKING_FAILURE",
    "message": "The resource was updated by another request. Refresh and try again.",
    "type": "https://docs.api.example.com/errors#optimistic-locking-failure",
    "instance": "/api/v1/places/place-001",
    "details": {
      "operationId": "op_123456789",
      "severity": "MEDIUM"
    },
    "recoveryActions": [
      "Refresh the resource and retry your operation"
    ]
  }
}
```

**Transaction Timeout**
```json
{
  "success": false,
  "statusCode": 408,
  "error": {
    "code": "TRANSACTION_TIMEOUT",
    "message": "The operation timed out. Please retry shortly.",
    "type": "https://docs.api.example.com/errors#transaction-timeout",
    "retryInfo": {
      "recommended": true,
      "retryAfterMs": 30000,
      "maxRetries": 3,
      "strategy": "EXPONENTIAL_BACKOFF"
    }
  }
}
```

### Error Code Reference

| HTTP Status | Error Code | Description | Retryable |
|-------------|------------|-------------|-----------|
| 400 | `VALIDATION_FAILED` | Request validation failed | No |
| 400 | `INVALID_REQUEST` | Request parameters invalid | No |
| 401 | `AUTHENTICATION_REQUIRED` | Authentication required | No |
| 401 | `AUTHENTICATION_FAILED` | Invalid credentials | No |
| 403 | `ACCESS_DENIED` | Insufficient permissions | No |
| 404 | `RESOURCE_NOT_FOUND` | Resource not found | No |
| 409 | `CONFLICT` | Resource conflict | Yes |
| 409 | `OPTIMISTIC_LOCKING_FAILURE` | Concurrent modification | Yes |
| 429 | `RATE_LIMIT_EXCEEDED` | Rate limit exceeded | Yes |
| 500 | `INTERNAL_SERVER_ERROR` | Internal server error | Yes |
| 503 | `SERVICE_UNAVAILABLE` | Service temporarily unavailable | Yes |
| 503 | `CIRCUIT_BREAKER_OPEN` | Circuit breaker open | Yes |

### Recovery Actions
Each error includes specific recovery actions to help clients handle the error:

- **Validation Errors**: Field-specific guidance on fixing input
- **Authentication Errors**: Steps to obtain valid credentials
- **Authorization Errors**: Contact information for access requests
- **Rate Limiting**: Retry timing and backoff strategies
- **Server Errors**: Retry policies and support contact

### Retry Strategies

#### Exponential Backoff
```
Initial delay: 1 second
Max delay: 60 seconds
Multiplier: 2
Jitter: Â±25%

Attempt 1: 1.0s Â± 0.25s
Attempt 2: 2.0s Â± 0.5s
Attempt 3: 4.0s Â± 1.0s
Attempt 4: 8.0s Â± 2.0s
```

#### Linear Backoff
```
Delay: 5 seconds
Max attempts: 3

Attempt 1: 5.0s
Attempt 2: 5.0s
Attempt 3: 5.0s
```

---

## ì†ë„ ì œí•œ ë° í˜ì´ì§€ë„¤ì´ì…˜

### ì†ë„ ì œí•œ

APIëŠ” ë‚¨ìš©ì„ ë°©ì§€í•˜ê³  ê³µì •í•œ ì‚¬ìš©ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ Redisë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë‹¨ê³„ ì†ë„ ì œí•œì„ êµ¬í˜„í•©ë‹ˆë‹¤.

#### ì†ë„ ì œí•œ Tiers

**Global IP Rate Limiting**
- **Limit**: 1,000 requests per hour per IP
- **Window**: 1 hour rolling window
- **Scope**: All endpoints combined

**API Endpoint Rate Limiting**
- **Limit**: 100 requests per minute per IP per endpoint
- **Window**: 1 minute rolling window
- **Scope**: Individual endpoint paths

**Authentication Rate Limiting**
- **Limit**: 5 login attempts per 15 minutes per IP
- **Window**: 15 minutes rolling window
- **Scope**: `/api/v1/auth/login` endpoint only

#### Rate Limit Headers
Every response includes rate limit information:

```http
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 85
X-RateLimit-Reset: 1699804920
X-RateLimit-Retry-After: 60
```

#### Rate Limit Exceeded Response
```json
{
  "success": false,
  "statusCode": 429,
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "Too many requests. Please try again later.",
    "type": "https://docs.api.example.com/errors#rate-limit-exceeded",
    "retryInfo": {
      "recommended": true,
      "retryAfterMs": 60000,
      "maxRetries": 3,
      "strategy": "EXPONENTIAL_BACKOFF"
    }
  }
}
```

#### IP Blocking
- IPs exceeding rate limits are temporarily blocked
- Block duration: 1 hour for repeated violations
- Automatic unblocking after cool-down period

### í˜ì´ì§€ë„¤ì´ì…˜

#### Standard Pagination Parameters
All list endpoints support standard Spring Data pagination:

```http
GET /api/v1/places?page=0&size=20&sort=name,asc
```

**Parameters:**
- `page`: Page number (0-based, default: 0)
- `size`: Page size (max: 100, default: 20)
- `sort`: Sort criteria (format: `field,direction`)

**Multiple Sort Criteria:**
```http
GET /api/v1/places?sort=name,asc&sort=createdAt,desc
```

#### í˜ì´ì§€ë„¤ì´ì…˜ Response Format
```json
{
  "success": true,
  "statusCode": 200,
  "data": [...],
  "pagination": {
    "currentPage": 0,
    "pageSize": 20,
    "totalPages": 5,
    "totalItems": 95,
    "isFirst": true,
    "isLast": false,
    "hasNext": true,
    "hasPrevious": false,
    "numberOfItems": 20
  }
}
```

#### Large Dataset Handling
For endpoints with potentially large datasets:

**Cursor-Based Pagination (for real-time data)**
```http
GET /api/v1/news?cursor=abc123&limit=20
```

**Response:**
```json
{
  "data": [...],
  "pagination": {
    "nextCursor": "def456",
    "hasNext": true,
    "limit": 20
  }
}
```

#### Performance Considerations
- **Maximum Page Size**: 100 items per page
- **Total Count**: Calculated efficiently using database optimizations
- **Deep Pagination**: Discouraged beyond page 1000 (use cursor-based for large offsets)

### Link Headers (RFC 5988)
For better navigation, pagination responses include Link headers:

```http
Link: <http://api.example.com/places?page=0&size=20>; rel="first",
      <http://api.example.com/places?page=2&size=20>; rel="next",
      <http://api.example.com/places?page=4&size=20>; rel="last"
```

---

## í•„í„°ë§ ë° ê²€ìƒ‰ ê¸°ëŠ¥

### ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ í•„í„°ë§

#### Standard Filters
Most list endpoints support common filtering patterns:

**Basic Filters:**
```http
GET /api/v1/projects/girls-band-cry/places?unitIds=unit-001,unit-002&includeShared=true
```

**Date Range Filtering:**
```http
GET /api/v1/places?createdAfter=2024-01-01T00:00:00Z&createdBefore=2024-12-31T23:59:59Z
```

**Geographic Filtering:**
```http
GET /api/v1/places/within-bounds?north=35.7&south=35.6&east=139.8&west=139.7
GET /api/v1/places/nearby?lat=35.6762&lon=139.6503&radius=1000
```

#### Advanced Filtering Syntax

**Multiple Values (OR logic):**
```http
GET /api/v1/places?tags=music,venue,live
```

**Range Filters:**
```http
GET /api/v1/places?visitCount.gte=10&visitCount.lte=100
```

**Supported Range Operators:**
- `gte`: Greater than or equal
- `gt`: Greater than
- `lte`: Less than or equal
- `lt`: Less than
- `eq`: Equal (default)
- `ne`: Not equal

**Text Filters:**
```http
GET /api/v1/places?name.contains=live&description.startsWith=Popular
```

**Supported Text Operators:**
- `contains`: Case-insensitive substring match
- `startsWith`: Case-insensitive prefix match
- `endsWith`: Case-insensitive suffix match
- `eq`: Exact match (default)
- `ilike`: Case-insensitive like with wildcards

### ì „ë¬¸ ê²€ìƒ‰

#### Global Search
```http
GET /api/v1/search/places?q=live house tokyo&project=girls-band-cry
```

**Response:**
```json
{
  "success": true,
  "statusCode": 200,
  "data": [
    {
      "id": "place-001",
      "name": "Tokyo Live House",
      "description": "Premier live music venue in Tokyo",
      "score": 0.95,
      "highlights": {
        "name": ["<mark>Tokyo</mark> <mark>Live</mark> <mark>House</mark>"],
        "description": ["Premier <mark>live</mark> music venue in <mark>Tokyo</mark>"]
      },
      "project": "girls-band-cry",
      "location": {
        "latitude": 35.6762,
        "longitude": 139.6503
      }
    }
  ],
  "pagination": {
    "currentPage": 0,
    "pageSize": 20,
    "totalItems": 15
  },
  "metadata": {
    "queryTime": "45ms",
    "searchTerms": ["live", "house", "tokyo"]
  }
}
```

#### Search Features
- **Fuzzy Matching**: Handles typos and variations
- **Relevance Scoring**: Results ranked by relevance
- **Highlighting**: Search terms highlighted in results
- **Faceted Search**: Filter by project, type, tags
- **Autocomplete**: Suggested completions

**Autocomplete Example:**
```http
GET /api/v1/search/suggest?q=tok&type=place
```

**Response:**
```json
{
  "suggestions": [
    "Tokyo Live House",
    "Tokyo Station",
    "Tokyo Tower"
  ]
}
```

### ì§€ë¦¬ì  ê²€ìƒ‰

#### Bounding Box Search
Find places within a rectangular area:

```http
GET /api/v1/projects/girls-band-cry/places/within-bounds?north=35.7&south=35.6&east=139.8&west=139.7
```

#### Radius Search
Find places within a specific distance:

```http
GET /api/v1/projects/girls-band-cry/places/nearby?lat=35.6762&lon=139.6503&radius=1000
```

**Parameters:**
- `lat`: Latitude in decimal degrees
- `lon`: Longitude in decimal degrees
- `radius`: Search radius in meters (max: 50,000m)

#### Geographic Response Format
```json
{
  "success": true,
  "statusCode": 200,
  "data": [
    {
      "id": "place-001",
      "name": "Nearby Venue",
      "latitude": 35.6765,
      "longitude": 139.6500,
      "distance": 45.7,
      "distanceUnit": "meters"
    }
  ]
}
```

### Advanced Search Operators

#### Boolean Logic
```http
GET /api/v1/search/places?q=(live OR venue) AND tokyo NOT closed
```

#### Field-Specific Search
```http
GET /api/v1/search/places?q=name:tokyo description:live tags:music
```

#### Wildcard Search
```http
GET /api/v1/search/places?q=tok* *house
```

#### Phrase Search
```http
GET /api/v1/search/places?q="live music venue"
```

### Filter Combinations

Combine multiple filtering approaches:

```http
GET /api/v1/projects/girls-band-cry/places
  ?q=live music
  &tags=venue,music
  &visitCount.gte=10
  &withinRadius=1000
  &lat=35.6762
  &lon=139.6503
  &createdAfter=2024-01-01T00:00:00Z
  &sort=distance,asc
  &page=0
  &size=20
```

### Search Performance
- **Caching**: Search results cached for 5 minutes
- **Indexes**: Full-text search indexes on name, description, tags
- **Limits**: Maximum 100 results per search
- **Timeout**: Search queries timeout after 30 seconds

---

## íŒŒì¼ ì—…ë¡œë“œ ë° ë¯¸ë””ì–´ ì²˜ë¦¬

### ì—…ë¡œë“œ ì•„í‚¤í…ì²˜
APIëŠ” ì„œë²„ ë¶€í•˜ë¥¼ ìµœì†Œí™”í•˜ê³  ì§ì ‘ í´ë¼ì´ì–¸íŠ¸-ì €ì¥ì†Œ ì—…ë¡œë“œë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ë³´ì•ˆ ì‚¬ì „ ì„œëª… URL ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ **Cloudflare R2**ë¥¼ ë¯¸ë””ì–´ ì €ì¥ì†Œë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.

### ì—…ë¡œë“œ í”Œë¡œìš°

#### 1. Request Presigned URL
```http
POST /api/v1/uploads/presigned-url
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...
Content-Type: application/json

{
  "fileName": "venue-exterior.jpg",
  "fileSize": 2048576,
  "contentType": "image/jpeg",
  "purpose": "place_photo",
  "metadata": {
    "placeId": "place-001",
    "description": "Venue exterior view",
    "tags": ["exterior", "entrance"]
  }
}
```

**Response:**
```json
{
  "success": true,
  "statusCode": 200,
  "data": {
    "uploadId": "upload_abc123def456",
    "presignedUrl": "https://girlsbandtabi.r2.cloudflare.com/uploads/2024/11/12/abc123-venue-exterior.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=...",
    "publicUrl": "https://cdn.girlsbandtabi.com/uploads/2024/11/12/abc123-venue-exterior.jpg",
    "expiresAt": "2024-11-12T10:15:00Z",
    "maxFileSize": 10485760,
    "allowedContentTypes": ["image/jpeg", "image/png", "image/webp"],
    "uploadMetadata": {
      "uploadId": "upload_abc123def456",
      "userId": "550e8400-e29b-41d4-a716-446655440000",
      "purpose": "place_photo",
      "createdAt": "2024-11-12T10:00:00Z"
    }
  },
  "metadata": {
    "requestId": "req_1699804800_1234",
    "timestamp": "2024-11-12T10:00:00Z"
  }
}
```

#### 2. Upload File to Presigned URL
```http
PUT https://girlsbandtabi.r2.cloudflare.com/uploads/2024/11/12/abc123-venue-exterior.jpg?X-Amz-Algorithm=...
Content-Type: image/jpeg
Content-Length: 2048576

[Binary file data]
```

#### 3. Confirm Upload
```http
POST /api/v1/uploads/upload_abc123def456/confirm
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...
```

**Response:**
```json
{
  "success": true,
  "statusCode": 200,
  "data": {
    "uploadId": "upload_abc123def456",
    "status": "confirmed",
    "publicUrl": "https://cdn.girlsbandtabi.com/uploads/2024/11/12/abc123-venue-exterior.jpg",
    "thumbnails": {
      "small": "https://cdn.girlsbandtabi.com/uploads/2024/11/12/abc123-venue-exterior_thumb_200.jpg",
      "medium": "https://cdn.girlsbandtabi.com/uploads/2024/11/12/abc123-venue-exterior_thumb_500.jpg",
      "large": "https://cdn.girlsbandtabi.com/uploads/2024/11/12/abc123-venue-exterior_thumb_1200.jpg"
    },
    "metadata": {
      "fileName": "venue-exterior.jpg",
      "fileSize": 2048576,
      "contentType": "image/jpeg",
      "width": 1920,
      "height": 1080,
      "uploadedAt": "2024-11-12T10:05:00Z"
    }
  }
}
```

### ì§€ì›ë˜ëŠ” íŒŒì¼ íƒ€ì…

#### Images
- **JPEG**: `.jpg`, `.jpeg` (max 10MB)
- **PNG**: `.png` (max 10MB)
- **WebP**: `.webp` (max 10MB)
- **HEIC**: `.heic` (mobile photos, max 10MB)

#### Documents
- **PDF**: `.pdf` (max 50MB)

#### Video (Future)
- **MP4**: `.mp4` (max 100MB)
- **WebM**: `.webm` (max 100MB)

### Upload Purposes
Different upload purposes have different validation and processing rules:

```typescript
type UploadPurpose = 
  | "place_photo"      // Place photos and images
  | "user_avatar"      // User profile pictures  
  | "place_guide"      // Guide documents and images
  | "news_image"       // News article images
  | "unit_photo"       // Band/unit photos
  | "event_banner"     // Event promotional images
  | "verification"     // Location verification photos
```

### ì´ë¯¸ì§€ ì²˜ë¦¬

#### Automatic Thumbnail Generation
All uploaded images automatically generate optimized thumbnails:

- **Small**: 200px max dimension (WebP, 85% quality)
- **Medium**: 500px max dimension (WebP, 85% quality) 
- **Large**: 1200px max dimension (WebP, 90% quality)
- **Original**: Preserved as uploaded

#### Image Optimization
- **Format Conversion**: Automatic WebP conversion for better compression
- **Quality Optimization**: Adaptive quality based on image content
- **Metadata Stripping**: EXIF data removed for privacy
- **Progressive JPEG**: For better loading experience

### Upload Limits and Security

#### ì†ë„ ì œí•œ
- **Daily Upload Limit**: 100 uploads per user per day
- **Hourly Upload Limit**: 20 uploads per user per hour
- **Concurrent Uploads**: 5 simultaneous uploads per user
- **Total Storage Per User**: 1GB maximum

#### Security Measures
- **File Type Validation**: MIME type and magic number verification
- **Virus Scanning**: All uploads scanned for malware
- **Content Moderation**: Automatic content analysis for inappropriate material
- **Access Control**: User can only upload to their own resources

#### Cost Protection
- **Daily Bandwidth Limit**: 10GB per day
- **Monthly Request Limit**: 1,000,000 requests per month
- **Emergency Shutdown**: Automatic disable at 95% of limits
- **Alerts**: Notifications at 80% of limits

### Upload Management

#### List User Uploads
```http
GET /api/v1/uploads/my?page=0&size=20&purpose=place_photo&status=confirmed
```

**Response:**
```json
{
  "success": true,
  "statusCode": 200,
  "data": [
    {
      "uploadId": "upload_abc123def456",
      "fileName": "venue-exterior.jpg",
      "purpose": "place_photo",
      "status": "confirmed",
      "publicUrl": "https://cdn.girlsbandtabi.com/uploads/2024/11/12/abc123-venue-exterior.jpg",
      "fileSize": 2048576,
      "contentType": "image/jpeg",
      "uploadedAt": "2024-11-12T10:05:00Z",
      "metadata": {
        "placeId": "place-001",
        "description": "Venue exterior view"
      }
    }
  ],
  "pagination": {
    "currentPage": 0,
    "pageSize": 20,
    "totalItems": 15
  }
}
```

#### Delete Upload
```http
DELETE /api/v1/uploads/upload_abc123def456
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9...
```

**Response:** 204 No Content

### CDN and Performance

#### Content Delivery Network
- **Global CDN**: Cloudflare CDN with edge caching
- **Cache TTL**: 30 days for images, 7 days for documents
- **Compression**: Automatic Brotli/Gzip compression
- **HTTP/2**: Full HTTP/2 support for faster loading

#### Performance Optimizations
- **WebP Support**: Automatic WebP serving to supported browsers
- **Responsive Images**: Multiple sizes for different screen densities
- **Lazy Loading**: Image URLs optimized for lazy loading patterns
- **Progressive Enhancement**: Fallback to original format if WebP unsupported

### Error Handling

#### Upload Validation Errors
```json
{
  "success": false,
  "statusCode": 400,
  "error": {
    "code": "INVALID_FILE_TYPE",
    "message": "File type not supported",
    "details": {
      "supportedTypes": ["image/jpeg", "image/png", "image/webp"],
      "receivedType": "image/gif"
    }
  }
}
```

#### Storage Quota Exceeded
```json
{
  "success": false,
  "statusCode": 413,
  "error": {
    "code": "STORAGE_QUOTA_EXCEEDED",
    "message": "User storage quota exceeded",
    "details": {
      "currentUsage": "950MB",
      "limit": "1GB",
      "availableSpace": "50MB"
    },
    "recoveryActions": [
      "Delete some existing uploads to free space",
      "Contact support to request quota increase"
    ]
  }
}
```

---

## OpenAPI/Swagger í†µí•©

### OpenAPI ì‚¬ì–‘
APIëŠ” ë¬¸ì„œì™€ API ì†Œë¹„ìë¥¼ ìœ„í•œ ê³„ì•½ ì—­í• ì„ ëª¨ë‘ ìˆ˜í–‰í•˜ëŠ” í¬ê´„ì ì¸ OpenAPI 3.1 ì‚¬ì–‘ì„ ì œê³µí•©ë‹ˆë‹¤.

#### Accessing the Specification

**OpenAPI JSON:**
```http
GET /api-docs
Accept: application/json
```

**OpenAPI YAML:**
```http  
GET /api-docs.yaml
Accept: application/yaml
```

**Interactive Documentation:**
```http
GET /swagger-ui.html
```

### OpenAPI Configuration
The API is configured with SpringDoc OpenAPI 3 with the following features:

```yaml
springdoc:
  api-docs:
    path: /api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    operations-sorter: method
    tags-sorter: alpha
    try-it-out-enabled: true
    filter: true
    display-request-duration: true
    display-operation-id: true
  show-actuator: true
  group-configs:
    - group: auth
      display-name: "ì¸ì¦ API"
      paths-to-match: ["/auth/**"]
    - group: api
      display-name: "REST API" 
      paths-to-match: ["/api/**"]
    - group: actuator
      display-name: "ëª¨ë‹ˆí„°ë§ API"
      paths-to-match: ["/actuator/**"]
```

### Security Schemes
The OpenAPI specification includes JWT Bearer authentication:

```yaml
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "JWT authentication using Bearer scheme"

security:
  - bearerAuth: []
```

### API Documentation Features

#### Comprehensive Annotations
All endpoints are thoroughly documented with:

```kotlin
@Operation(
  summary = "Create a new place",
  description = "Creates a new place in the specified project. Requires admin permissions.",
  responses = [
    ApiResponse(responseCode = "201", description = "Place created successfully"),
    ApiResponse(responseCode = "400", description = "Invalid request data"),
    ApiResponse(responseCode = "401", description = "Authentication required"),
    ApiResponse(responseCode = "403", description = "Insufficient permissions")
  ]
)
@PreAuthorize("hasRole('ADMIN') or @projectAuth.isProjectAdminById(#projectId)")
fun createPlace(
  @PathVariable 
  @Parameter(description = "Project identifier", example = "girls-band-cry")
  projectId: String,
  
  @Valid @RequestBody
  @io.swagger.v3.oas.annotations.parameters.RequestBody(
    description = "Place creation data",
    required = true
  )
  body: CreatePlaceRequest
): ResponseEntity<ApiResponse<PlaceDetailDto>>
```

#### Schema Documentation
All DTOs include comprehensive schema annotations:

```kotlin
@Schema(description = "Standardized API response wrapper")
data class ApiResponse<T>(
  @Schema(description = "Indicates whether the request was successful", example = "true")
  val success: Boolean,
  
  @Schema(description = "HTTP status code", example = "200")
  val statusCode: Int,
  
  @Schema(description = "Response data (present on success)")
  val data: T? = null,
  
  @Schema(description = "Error information (present on failure)")
  val error: ErrorDetail? = null
)
```

#### Example Responses
Each endpoint includes example requests and responses:

```kotlin
@Operation(
  summary = "Authenticate user login",
  requestBody = @RequestBody(
    content = [Content(
      mediaType = "application/json",
      examples = [ExampleObject(
        name = "login",
        value = """{"username": "user@example.com", "password": "SecurePassword123!"}"""
      )]
    )]
  )
)
```

### Interactive Documentation

#### Swagger UI Features
The Swagger UI provides:

- **Try It Out**: Execute API calls directly from the documentation
- **Authentication**: Built-in JWT token management
- **Request/Response Inspection**: Live request and response viewing
- **Schema Exploration**: Interactive schema browsers
- **Example Generation**: Automatic example generation from schemas

#### Authentication in Swagger UI
```javascript
// Authenticate in Swagger UI
const token = "eyJhbGciOiJIUzI1NiJ9...";
SwaggerUI.preauthorizeApiKey("bearerAuth", `Bearer ${token}`);
```

### API Groups
The documentation is organized into logical groups:

#### Authentication APIs (`/auth/**`)
- User registration and login
- Token management
- OAuth2 integration (future)

#### Core APIs (`/api/**`)
- Place management
- File uploads  
- Search functionality
- User management

#### Monitoring APIs (`/actuator/**`)
- Health checks
- Metrics
- Application information

### Code Generation
The OpenAPI specification supports client code generation:

#### Generate TypeScript Client
```bash
npx @openapitools/openapi-generator-cli generate \
  -i http://localhost:8080/api-docs \
  -g typescript-fetch \
  -o ./src/api-client
```

#### Generate Java Client
```bash
openapi-generator-cli generate \
  -i http://localhost:8080/api-docs \
  -g java \
  --library okhttp-gson \
  -o ./java-client
```

#### Generate Python Client  
```bash
openapi-generator-cli generate \
  -i http://localhost:8080/api-docs \
  -g python \
  -o ./python-client
```

### Validation and Testing

#### OpenAPI Validation
```bash
# Validate OpenAPI specification
swagger-codegen validate -i http://localhost:8080/api-docs

# Test with Postman
newman run girls-band-tabi-api.postman_collection.json

# API testing with Dredd
dredd http://localhost:8080/api-docs http://localhost:8080
```

#### Contract Testing
```yaml
# Example Pact contract test
interactions:
  - description: "Get place details"
    request:
      method: GET
      path: "/api/v1/projects/girls-band-cry/places/place-001"
      headers:
        Authorization: "Bearer validtoken"
    response:
      status: 200
      headers:
        Content-Type: "application/json"
      body:
        success: true
        statusCode: 200
        data:
          id: "place-001"
          name: "Live House Venue"
```

### Customization

#### Custom OpenAPI Processors
```kotlin
@Component
class CustomOpenApiProcessor : OpenAPIProcessor {
    override fun process(openApi: OpenAPI) {
        // Add custom headers, examples, etc.
        openApi.info.contact = Contact()
            .name("API Support")
            .email("api-support@girlsbandtabi.com")
            .url("https://docs.girlsbandtabi.com")
    }
}
```

---

## í…ŒìŠ¤íŠ¸ ì „ëµ ë° ë„êµ¬

### í…ŒìŠ¤íŠ¸ ì² í•™
APIëŠ” ì‹ ë¢°ì„±, ì„±ëŠ¥ ë° ì •í™•ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ë ˆì´ì–´ë¥¼ ê°€ì§„ í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸ ì „ëµì„ ë”°ë¦…ë‹ˆë‹¤.

### í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ

#### Unit Tests (70%)
Fast, isolated tests for individual components:

```kotlin
@ExtendWith(MockitoExtension::class)
class PlaceServiceTest {
    
    @Mock
    private lateinit var placeRepository: PlaceRepository
    
    @Mock  
    private lateinit var auditLogger: AuditLogger
    
    @InjectMocks
    private lateinit var placeService: PlaceService
    
    @Test
    fun `should create place with valid data`() {
        // Given
        val request = CreatePlaceRequest(
            name = "Test Venue",
            description = "Test description",
            latitude = 35.6762,
            longitude = 139.6503
        )
        val expectedPlace = PlaceEntity(/* ... */)
        
        given(placeRepository.save(any())).willReturn(expectedPlace)
        
        // When
        val result = placeService.create("project-code", request)
        
        // Then
        assertThat(result.name).isEqualTo("Test Venue")
        verify(auditLogger).log(
            eventType = "PLACE",
            action = "CREATE ${result.id}",
            entityType = "PLACE", 
            entityId = result.id,
            success = true
        )
    }
}
```

#### Integration Tests (20%)
Tests for component interactions and external dependencies:

```kotlin
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@TestPropertySource(properties = [
    "spring.datasource.url=jdbc:h2:mem:testdb",
    "spring.jpa.hibernate.ddl-auto=create-drop"
])
@Transactional
class PlaceControllerIntegrationTest {
    
    @Autowired
    private lateinit var testRestTemplate: TestRestTemplate
    
    @Autowired 
    private lateinit var placeRepository: PlaceRepository
    
    @Test
    fun `should create place when authenticated as admin`() {
        // Given
        val authToken = generateAdminToken()
        val request = CreatePlaceRequest(/* ... */)
        
        val headers = HttpHeaders().apply {
            setBearerAuth(authToken)
            contentType = MediaType.APPLICATION_JSON
        }
        
        // When
        val response = testRestTemplate.exchange(
            "/api/v1/projects/test-project/places",
            HttpMethod.POST,
            HttpEntity(request, headers),
            object : ParameterizedTypeReference<ApiResponse<PlaceDetailDto>>() {}
        )
        
        // Then
        assertThat(response.statusCode).isEqualTo(HttpStatus.CREATED)
        assertThat(response.body?.success).isTrue()
        assertThat(response.body?.data?.name).isEqualTo(request.name)
        
        val savedPlace = placeRepository.findByName(request.name)
        assertThat(savedPlace).isNotNull()
    }
}
```

#### End-to-End Tests (10%)
Full system tests simulating real user scenarios:

```kotlin
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@Testcontainers
class PlaceManagementE2ETest {
    
    companion object {
        @Container
        val postgres = PostgreSQLContainer<Nothing>("postgres:15-alpine").apply {
            withDatabaseName("testdb")
            withUsername("test")
            withPassword("test")
        }
        
        @Container
        val redis = GenericContainer<Nothing>("redis:7-alpine").apply {
            withExposedPorts(6379)
        }
    }
    
    @Test
    fun `complete place management workflow`() {
        // 1. Register user
        val registerResponse = registerUser("test@example.com", "TestUser", "password123")
        assertThat(registerResponse.statusCode).isEqualTo(HttpStatus.CREATED)
        
        val accessToken = registerResponse.body?.data?.accessToken!!
        
        // 2. Create place (should fail - not admin)
        val createResponse = createPlace(accessToken, CreatePlaceRequest(/* ... */))
        assertThat(createResponse.statusCode).isEqualTo(HttpStatus.FORBIDDEN)
        
        // 3. Login as admin
        val adminToken = loginAsAdmin()
        
        // 4. Create place (should succeed)
        val placeResponse = createPlace(adminToken, CreatePlaceRequest(/* ... */))
        assertThat(placeResponse.statusCode).isEqualTo(HttpStatus.CREATED)
        
        val placeId = placeResponse.body?.data?.id!!
        
        // 5. Upload photo
        val uploadResponse = uploadPlacePhoto(accessToken, placeId, "test-photo.jpg")
        assertThat(uploadResponse.statusCode).isEqualTo(HttpStatus.OK)
        
        // 6. Add comment  
        val commentResponse = addPlaceComment(accessToken, placeId, "Great venue!")
        assertThat(commentResponse.statusCode).isEqualTo(HttpStatus.CREATED)
        
        // 7. Search for place
        val searchResponse = searchPlaces("venue")
        assertThat(searchResponse.body?.data?.any { it.id == placeId }).isTrue()
    }
}
```

### Testing Tools and Frameworks

#### Core Testing Framework
- **JUnit 5**: Modern testing framework with parameterized tests
- **AssertJ**: Fluent assertions for better readability
- **Mockito**: Mocking framework for unit tests
- **TestContainers**: Integration testing with real databases
- **WireMock**: External service mocking

#### API Testing Tools
- **Spring MockMvc**: Web layer testing without full HTTP server
- **RestAssured**: REST API testing with fluent DSL
- **WebTestClient**: Reactive web testing (when using WebFlux)
- **Testcontainers**: Real database and Redis instances

#### Example RestAssured Test
```kotlin
@TestMethodOrder(OrderAnnotation::class)
class PlaceAPITest : BaseIntegrationTest() {
    
    @Test
    @Order(1)
    fun `should authenticate and get token`() {
        val response = given()
            .contentType(ContentType.JSON)
            .body(LoginRequest("admin@example.com", "admin123"))
        .`when`()
            .post("/api/v1/auth/login")
        .then()
            .statusCode(200)
            .body("success", equalTo(true))
            .body("data.accessToken", notNullValue())
            .extract().response()
            
        accessToken = response.path("data.accessToken")
    }
    
    @Test
    @Order(2)  
    fun `should create place with authentication`() {
        val placeRequest = CreatePlaceRequest(
            name = "Test Live House",
            description = "A test venue",
            latitude = 35.6762,
            longitude = 139.6503,
            address = "Tokyo, Japan",
            tags = listOf("music", "venue"),
            unitIds = listOf("unit-001")
        )
        
        given()
            .header("Authorization", "Bearer $accessToken")
            .contentType(ContentType.JSON)
            .body(placeRequest)
        .`when`()
            .post("/api/v1/projects/test-project/places")
        .then()
            .statusCode(201)
            .body("success", equalTo(true))
            .body("data.name", equalTo("Test Live House"))
            .body("data.latitude", equalTo(35.6762f))
    }
}
```

### Performance Testing

#### Load Testing with K6
```javascript
import http from 'k6/http';
import { check } from 'k6';

export let options = {
  stages: [
    { duration: '2m', target: 100 },  // Ramp up to 100 users
    { duration: '5m', target: 100 },  // Stay at 100 users
    { duration: '2m', target: 0 },    // Ramp down
  ],
  thresholds: {
    http_req_duration: ['p(95)<1000'], // 95% of requests under 1000ms
    http_req_failed: ['rate<0.1'],     // Error rate under 10%
  },
};

export default function() {
  // Login and get token
  const loginResponse = http.post('http://localhost:8080/api/v1/auth/login', 
    JSON.stringify({
      username: 'test@example.com',
      password: 'password123'
    }), {
      headers: { 'Content-Type': 'application/json' }
    }
  );
  
  check(loginResponse, {
    'login status is 200': (r) => r.status === 200,
    'login has token': (r) => JSON.parse(r.body).data.accessToken !== null,
  });
  
  const token = JSON.parse(loginResponse.body).data.accessToken;
  
  // Search places
  const searchResponse = http.get(
    'http://localhost:8080/api/v1/search/places?q=venue',
    {
      headers: { 'Authorization': `Bearer ${token}` }
    }
  );
  
  check(searchResponse, {
    'search status is 200': (r) => r.status === 200,
    'search returns results': (r) => JSON.parse(r.body).data.length > 0,
  });
}
```

#### JMeter Performance Tests
```xml
<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2">
  <hashTree>
    <TestPlan testname="Girls Band Tabi API Performance Test">
      <elementProp name="arguments" elementType="Arguments"/>
    </TestPlan>
    <hashTree>
      <ThreadGroup testname="API Load Test">
        <stringProp name="ThreadGroup.num_threads">50</stringProp>
        <stringProp name="ThreadGroup.ramp_time">60</stringProp>
        <stringProp name="ThreadGroup.duration">300</stringProp>
      </ThreadGroup>
    </hashTree>
  </hashTree>
</jmeterTestPlan>
```

### Security Testing

#### OWASP ZAP Integration
```kotlin
@Test
fun `security scan with ZAP`() {
    val zapClient = ClientApi("localhost", 8080)
    
    // Start spider scan
    zapClient.spider.scan("http://localhost:8080/api/v1/")
    
    // Wait for spider to complete
    while (zapClient.spider.status("0").toInt() < 100) {
        Thread.sleep(1000)
    }
    
    // Start active scan
    zapClient.ascan.scan("http://localhost:8080/api/v1/", "True", "False", "", "", "", "")
    
    // Generate report
    val report = zapClient.core.htmlreport()
    // Assert no high-risk vulnerabilities found
}
```

#### Authentication Testing
```kotlin
@Test
fun `should reject requests without authentication`() {
    given()
        .contentType(ContentType.JSON)
    .`when`()
        .get("/api/v1/places")
    .then()
        .statusCode(401)
        .body("error.code", equalTo("AUTHENTICATION_REQUIRED"))
}

@Test  
fun `should reject expired tokens`() {
    val expiredToken = generateExpiredToken()
    
    given()
        .header("Authorization", "Bearer $expiredToken")
    .`when`()
        .get("/api/v1/places")
    .then()
        .statusCode(401)
        .body("error.code", equalTo("AUTHENTICATION_FAILED"))
}
```

### Test Data Management

#### Test Fixtures
```kotlin
@Component
class TestDataBuilder {
    
    fun createTestUser(
        email: String = "test@example.com",
        nickname: String = "TestUser",
        role: UserRole = UserRole.USER
    ): UserEntity {
        return UserEntity(
            id = UUID.randomUUID(),
            email = email,
            nickname = nickname,
            passwordHash = "hashed_password",
            role = role,
            createdAt = Instant.now(),
            updatedAt = Instant.now()
        )
    }
    
    fun createTestPlace(
        projectCode: String = "test-project",
        name: String = "Test Venue"
    ): PlaceEntity {
        return PlaceEntity(
            id = UUID.randomUUID().toString(),
            name = name,
            description = "Test description",
            latitude = 35.6762,
            longitude = 139.6503,
            address = "Tokyo, Japan",
            projectCode = projectCode,
            createdAt = Instant.now(),
            updatedAt = Instant.now()
        )
    }
}
```

#### Database Cleanup
```kotlin
@Component
@Transactional
class TestDatabaseCleaner {
    
    @Autowired
    private lateinit var entityManager: EntityManager
    
    fun cleanDatabase() {
        val tableNames = listOf(
            "place_comments",
            "place_photos", 
            "places",
            "uploads",
            "users"
        )
        
        entityManager.flush()
        entityManager.createNativeQuery("SET REFERENTIAL_INTEGRITY FALSE").executeUpdate()
        
        tableNames.forEach { tableName ->
            entityManager.createNativeQuery("TRUNCATE TABLE $tableName").executeUpdate()
        }
        
        entityManager.createNativeQuery("SET REFERENTIAL_INTEGRITY TRUE").executeUpdate()
    }
}
```

### Continuous Testing

#### GitHub Actions CI/CD
```yaml
name: API Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_DB: testdb
          POSTGRES_USER: test
          POSTGRES_PASSWORD: test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
      
      redis:
        image: redis:7
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up JDK 17
        uses: actions/setup-java@v3
        with:
          java-version: '17'
          distribution: 'temurin'
      
      - name: Run unit tests
        run: ./gradlew test
      
      - name: Run integration tests
        run: ./gradlew integrationTest
        env:
          SPRING_DATASOURCE_URL: jdbc:postgresql://localhost:5432/testdb
          SPRING_DATASOURCE_USERNAME: test
          SPRING_DATASOURCE_PASSWORD: test
          SPRING_DATA_REDIS_HOST: localhost
      
      - name: Generate test report
        uses: dorny/test-reporter@v1
        if: success() || failure()
        with:
          name: Test Results
          path: build/test-results/**/*.xml
          reporter: java-junit
```

### Test Coverage
Target coverage metrics:
- **Line Coverage**: >90%
- **Branch Coverage**: >85%  
- **Method Coverage**: >95%

```kotlin
// JaCoCo configuration in build.gradle.kts
jacocoTestCoverageVerification {
    violationRules {
        rule {
            limit {
                minimum = "0.90".toBigDecimal()
            }
        }
        rule {
            element = "BRANCH"
            limit {
                minimum = "0.85".toBigDecimal()
            }
        }
    }
}
```

### Testing Best Practices

1. **Test Pyramid**: 70% unit, 20% integration, 10% E2E
2. **Fast Feedback**: Unit tests run in <5 minutes
3. **Isolated Tests**: Each test is independent and can run in any order
4. **Meaningful Names**: Test names clearly describe the scenario
5. **Data-Driven Tests**: Use parameterized tests for multiple scenarios
6. **Continuous Integration**: All tests run on every commit
7. **Test Documentation**: Complex test scenarios are documented
8. **Performance Baselines**: Load tests establish performance benchmarks

---

## 2025-11-17 ë³€ê²½ ìš”ì•½
- ì¥ì†Œ ëª©ë¡/ìƒì„¸ ì‘ë‹µì— `introText` í•„ë“œë¥¼ ì¶”ê°€í•´ ì¹´ë“œ UIÂ·SNS ê³µìœ  ë¬¸êµ¬ë¥¼ ì„œë²„ì—ì„œ ì§ì ‘ ì œê³µí•˜ë„ë¡ í‘œì¤€í™”í–ˆìŠµë‹ˆë‹¤.
- `regionSummary` ê°ì²´(code, primaryName, path, level)ë¥¼ ëª¨ë“  ì¥ì†Œ ì‘ë‹µì— í¬í•¨í•´ í”„ëŸ°íŠ¸ì—”ë“œê°€ ì¶”ê°€ API í˜¸ì¶œ ì—†ì´ ì§€ì—­ ì •ë ¬Â·ê·¸ë£¹í•‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë‹¨ì¼ `type` í•„ë“œë¥¼ ì œê±°í•˜ê³  `types` ë°°ì—´ë§Œ ìœ ì§€í•˜ì—¬ ë‹¤ì¤‘ ë¶„ë¥˜ ê³„ì•½ì„ ë‹¨ìˆœí™”í–ˆìŠµë‹ˆë‹¤. Admin APIëŠ” ìë™ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µí•´ ìµœì†Œ 1ê°œì˜ íƒ€ì…ì„ ë³´ì¥í•©ë‹ˆë‹¤.
- Admin ìƒì„±/ìˆ˜ì • ìš”ì²­ ë³¸ë¬¸ì—ì„œ `introText`(ì„ íƒ)ë¥¼ ì§€ì›í•˜ë©°, ë¹„ì–´ ìˆì„ ê²½ìš° ì„œë²„ê°€ `description` ì•ë¶€ë¶„(ìµœëŒ€ 200ì)ìœ¼ë¡œ ìë™ ì±„ì›Œ ì´ˆê¸° ìš´ì˜ ë¶€ë‹´ì„ ì¤„ì˜€ìŠµë‹ˆë‹¤.

## ê²°ë¡ 

ì´ í¬ê´„ì ì¸ API ë¬¸ì„œëŠ” ê°œë°œìë“¤ì´ Girls Band Tabi APIì™€ ì„±ê³µì ìœ¼ë¡œ í†µí•©í•˜ëŠ” ë° í•„ìš”í•œ ëª¨ë“  ê²ƒì„ ì œê³µí•©ë‹ˆë‹¤. RESTful ì„¤ê³„ ì›ì¹™, í¬ê´„ì ì¸ ì˜¤ë¥˜ ì²˜ë¦¬, ê²¬ê³ í•œ ë³´ì•ˆ, ê´‘ë²”ìœ„í•œ í…ŒìŠ¤íŠ¸ì˜ ì¡°í•©ì€ ì‹ ë¢°í•  ìˆ˜ ìˆê³  ê°œë°œì ì¹œí™”ì ì¸ ê²½í—˜ì„ ë³´ì¥í•©ë‹ˆë‹¤.

ì¶”ê°€ ì§€ì›:
- **API ì§€ì›**: api-support@girlsbandtabi.com
- **ë¬¸ì„œ**: https://docs.girlsbandtabi.com  
- **ìƒíƒœ í˜ì´ì§€**: https://status.girlsbandtabi.com
- **GitHub Issues**: https://github.com/girlsbandtabi/api/issues

APIëŠ” ê°œë°œì í”¼ë“œë°±ê³¼ ì‚¬ìš© íŒ¨í„´ì„ ë°”íƒ•ìœ¼ë¡œ ì§€ì†ì ìœ¼ë¡œ ë°œì „í•˜ê³  ìˆìŠµë‹ˆë‹¤. ìµœì‹  ì—…ë°ì´íŠ¸ì™€ ìƒˆë¡œìš´ ê¸°ëŠ¥ì— ëŒ€í•œ ë‚´ìš©ì€ ë³€ê²½ë¡œê·¸ì™€ ë²„ì „ ë…¸íŠ¸ë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.
